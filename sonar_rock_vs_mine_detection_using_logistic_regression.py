# -*- coding: utf-8 -*-
"""SONAR Rock vs Mine Detection using Logistic Regression.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Z3VGmUb8L2OUY9hahgLhmG-Efcbhhtqi
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

#Data processing

df = pd.read_csv("/content/Copy of sonar data.csv")

df.head()

df.shape

X = df.iloc[:,:-1]
Y = df.iloc[:,-1]

X.head()

Y.head()

Y.info()

Y.describe()

from sklearn.model_selection import train_test_split

X_train, X_test, Y_train, Y_test = train_test_split(X,Y,test_size=0.2,stratify = Y,random_state=42)

print(X.shape, X_train.shape, X_test.shape)

model = LogisticRegression()

model.fit(X_train,Y_train)

#Accuracy on training data
X_train_prediction = model.predict(X_train)
training_data_accuracy = accuracy_score(X_train_prediction,Y_train)

print("Accuracy on training data:",training_data_accuracy)

#Accuracy on test data
X_test_prediction = model.predict(X_test)
test_data_accuracy = accuracy_score(X_test_prediction,Y_test)

print("Accuracy on test data:",test_data_accuracy)

"""**Make a predictive system**"""

input_data = (0.0114, 0.0222, 0.0269, 0.0384, 0.1217, 0.2062, 0.1489, 0.0929, 0.1350, 0.1799, 0.2486, 0.2973, 0.3672, 0.4394, 0.5258, 0.6755, 0.7402, 0.8284, 0.9033, 0.9584, 1.0000, 0.9982, 0.8899, 0.7493, 0.6367, 0.6744, 0.7207, 0.6821, 0.5512, 0.4789, 0.3924, 0.2533, 0.1089, 0.1390, 0.2551, 0.3301, 0.2818, 0.2142, 0.2266, 0.2142, 0.2354, 0.2871, 0.2596, 0.1925, 0.1256, 0.1003, 0.0951, 0.1210, 0.0728, 0.0174, 0.0213, 0.0269, 0.0152, 0.0257, 0.0097, 0.0041, 0.0050, 0.0145, 0.0103, 0.0025
)
#changing input data to a numpy array

numpy_array = np.asarray(input_data)
print("numpy_array shape:",numpy_array.shape)
data_reshaped = numpy_array.reshape(1,-1)
print("data_reshaped shape:",data_reshaped.shape)

prediction = model.predict(data_reshaped)

print(prediction)

if prediction[0] == 'R':
  print("Object is a rock")
else :
  print("Object is a mine")

